DROP DATA BASE IF EXISTS CDA; 
CREATE DATABASE CDA DEFAULT CARACTER SET utf8;
USE CDA;


 
  
  
CREATE TABLE Bureaux(
   idBureau INT AUTO_INCREMENT PRIMARY KEY,
   codePostal VARCHAR(6) 
   
) ENGINE=InnoDB;

   
 
CREATE TABLE Types(
   idType INT AUTO_INCREMENT PRIMARY KEY,
   libelleType VARCHAR(50) 
 
   
) ENGINE=InnoDB;


  
  
CREATE TABLE Courriers(

   idCourrier INT AUTO_INCREMENT PRIMARY KEY,
   rueDestinataire VARCHAR(150)  NOT NULL,
   numDestintaire VARCHAR(5)  NOT NULL,
   rueEmetteur VARCHAR(150) ,
   numEmetteur VARCHAR(50) ,
   idType INT NOT NULL
   
   
) ENGINE=InnoDB;


   
CREATE TABLE Transports(
   idTransport INT AUTO_INCREMENT  PRIMARY KEY,
   libelleTransport VARCHAR(50) ,
   taxeCarbonne INT
  
) ENGINE=InnoDB;


   
CREATE TABLE Centres_de_tri(
   idCentresDeTri INT AUTO_INCREMENT PRIMARY KEY,
   nomCentreDeTri VARCHAR(50) 
   
) ENGINE=InnoDB;


CREATE TABLE Achemine(
   idBureau INT,
   idTransport INT,
   idCentresDeTri INT,
   PRIMARY KEY(idBureau, idTransport, idCentresDeTri)
   
) ENGINE=InnoDB;

 
CREATE TABLE Gere(
   idBureau INT,
   idCourrier INT,
   dateEnvoi DATE,
   dateReception DATE,
   PRIMARY KEY(idBureau, idCourrier)
   
   
) ENGINE=InnoDB;
ALTER TABLE Courriers
ADD CONSTRAINT FK_courrier_types
FOREIGN KEY(idType) REFERENCES Types(idType);

ALTER TABLE Achemine
ADD CONSTRAINT FK_achemine_bureau
FOREIGN KEY(idBureau) REFERENCES Bureaux(idBureau),
ADD CONSTRAINT FK_achemine_transport
FOREIGN KEY(idTransport) REFERENCES Transports(idTransport),
ADD CONSTRAINT FK_achemine_centre_de_tri
FOREIGN KEY(idCentresDeTri) REFERENCES Centres_de_tri(idCentresDeTri);

ALTER TABLE Gere
ADD CONSTRAINT FK_Gere_bureau
FOREIGN KEY(idBureau) REFERENCES Bureaux(idBureau),
ADD CONSTRAINT FK_Gere_courrier
FOREIGN KEY(idCourrier) REFERENCES Courriers(idCourrier);


